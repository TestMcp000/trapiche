@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Apple/Google-inspired Palette */
  --background: #ffffff;
  --background-rgb: 255 255 255;
  --foreground: #1d1d1f; /* Soft Black */
  --foreground-rgb: 29 29 31;

  /* Semantic Colors - can be overridden via server-rendered inline styles */
  --primary: #0071e3; /* Tech Blue - for buttons, links */
  --primary-rgb: 0 113 227;
  --primary-hover: #0077ed;
  --primary-hover-rgb: 0 119 237;
  --theme-rgb: 0 113 227; /* RGB triplet for gradients + Tailwind alpha colors */
  --secondary: #5a5a5f; /* Secondary Text - Darkened for WCAG AA 4.5:1 contrast */
  --secondary-rgb: 90 90 95;
  --surface: #f5f5f7; /* Light Gray Background */
  --surface-rgb: 245 245 247;
  --surface-hover: #e8e8ed;
  --surface-hover-rgb: 232 232 237;
  --surface-raised: #ffffff;
  --surface-raised-rgb: 255 255 255;
  --surface-raised-hover: #f5f5f7;
  --surface-raised-hover-rgb: 245 245 247;

  /* Borders */
  --border: #d2d2d7;
  --border-rgb: 210 210 215;
  --border-light: #e5e5ea;
  --border-light-rgb: 229 229 234;

  /* Theme tokens (fallbacks; normally injected by SSR theme system) */
  --theme-font: system-ui, -apple-system, sans-serif;
  --theme-blur: 0px;
  --theme-radius: 6px;
  --theme-radius-lg: 12px;
  --theme-spacing: 1;
  --theme-filter: none;

  /* Glass utilities (fallbacks; injected by SSR resolver) */
  --glass-surface: rgba(255, 255, 255, 0.72);
  --glass-border: rgba(0, 0, 0, 0.08);
}

@media (prefers-color-scheme: dark) {
  /* Optional: Minimalist Dark Mode Support (if user system prefers it) 
     keeping it subtly aligned or override if strict light mode is requested.
     For now, enforcing light mode aesthetic as requested ("Clean, Light"), 
     but providing dark vars just in case we want to toggle later. 
     The user requested specifically similar to Apple/Google which are usually light by default 
     for corporate/product pages, but let's stick to the light theme primarily. */
}

body {
  background: linear-gradient(
    180deg,
    rgb(var(--theme-rgb) / 0.05) 0%,
    rgb(var(--theme-rgb) / 0.02) 40%,
    rgb(var(--background-rgb) / 1) 100%
  );
  min-height: 100vh;
  color: rgb(var(--foreground-rgb) / 1);
  font-feature-settings: "cv02", "cv03", "cv04", "cv11";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

html {
  scroll-behavior: smooth;
}

/* Utilities */
@layer utilities {
  .glass {
    background-color: var(--glass-surface);
    border-bottom: 1px solid var(--glass-border);
    backdrop-filter: blur(var(--theme-blur));
    -webkit-backdrop-filter: blur(var(--theme-blur));
  }

  .glass-card {
    background-color: var(--glass-surface);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(var(--theme-blur));
    -webkit-backdrop-filter: blur(var(--theme-blur));
  }

  .text-balance {
    text-wrap: balance;
  }
}

@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  .glass,
  .glass-card {
    background-color: rgb(var(--surface-raised-rgb) / 0.95);
  }
}

/* Theme Scope wrapper (per-page themes) */
.theme-scope {
  background: linear-gradient(
    180deg,
    rgb(var(--theme-rgb) / 0.05) 0%,
    rgb(var(--theme-rgb) / 0.02) 40%,
    rgb(var(--background-rgb) / 1) 100%
  );
  color: rgb(var(--foreground-rgb) / 1);
  min-height: 100vh;
}

/* Theme filter (Japanese Airy, etc.) - public scopes only */
.theme-scope img,
.theme-scope video {
  filter: var(--theme-filter);
}

/* Custom scrollbar - thinner and lighter */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #a8a8a8;
}

/* Note: Prism CSS moved to app/markdown-prism.css for performance (P0) */

/* Prose customizations via theme tokens (works for all themes, no .dark dependency) */
.prose {
  --tw-prose-body: rgb(var(--foreground-rgb) / 0.9);
  --tw-prose-headings: rgb(var(--foreground-rgb) / 1);
  --tw-prose-lead: rgb(var(--foreground-rgb) / 0.9);
  --tw-prose-links: rgb(var(--primary-rgb) / 1);
  --tw-prose-bold: rgb(var(--foreground-rgb) / 1);
  --tw-prose-counters: rgb(var(--secondary-rgb) / 1);
  --tw-prose-bullets: rgb(var(--secondary-rgb) / 1);
  --tw-prose-hr: rgb(var(--border-rgb) / 1);
  --tw-prose-quotes: rgb(var(--foreground-rgb) / 0.85);
  --tw-prose-quote-borders: rgb(var(--border-rgb) / 1);
  --tw-prose-captions: rgb(var(--secondary-rgb) / 1);
  --tw-prose-code: rgb(var(--foreground-rgb) / 1);
  --tw-prose-pre-code: rgb(var(--foreground-rgb) / 1);
  --tw-prose-pre-bg: rgb(var(--surface-rgb) / 1);
  --tw-prose-th-borders: rgb(var(--border-rgb) / 1);
  --tw-prose-td-borders: rgb(var(--border-light-rgb) / 1);
}

/* Scrollytelling: progressive enhancement */
.scrollytelling-root[data-scrollytelling='enabled'] section {
  transition: opacity 600ms ease, transform 600ms ease;
  will-change: opacity, transform;
}

.scrollytelling-root[data-scrollytelling='enabled'] section:not([data-scrolly-visible='true']) {
  opacity: 0;
  transform: translateY(24px);
}

.scrollytelling-root[data-scrollytelling='enabled'] section[data-scrolly-visible='true'] {
  opacity: 1;
  transform: translateY(0);
}

/* Respect user motion preferences (replaces MotionPreference.tsx) */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .scrollytelling-root section {
    transition: none !important;
    transform: none !important;
    opacity: 1 !important;
  }
}
